<!DOCTYPE html>
<html lang="en" data-lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeLabubu.ca - Premium Labubu Dolls & Collectibles</title>
    <meta name="title-key" content="site_title">
    
    <!-- Favicon -->
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Stripe JS -->
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
            <div class="container">
                <a class="navbar-brand" href="/"><span class="title-le">Le</span><span class="title-labubu">Labubu</span>.ca</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="/" data-translate="nav_home">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="shop.html" data-translate="nav_shop">Shop</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="about.html" data-translate="nav_about">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="contact.html" data-translate="nav_contact">Contact</a>
                        </li>
                    </ul>
                    <div class="d-flex flex-column flex-lg-row align-items-start align-items-lg-center mt-3 mt-lg-0">
                        <form class="d-flex me-lg-2 mb-2 mb-lg-0 w-100" id="searchForm">
                            <input class="form-control me-2" type="search" name="search" data-translate-placeholder="search_placeholder" placeholder="Search products..." aria-label="Search">
                            <button class="btn btn-outline-primary" type="submit" data-translate-title="search_button">
                                <i class="fas fa-search"></i>
                            </button>
                        </form>
                        <div id="user-session" class="d-flex align-items-center">
                            <!-- This will be populated by JavaScript -->
                        </div>
                        <div class="d-flex align-items-center ms-lg-2">
                            <a href="cart.html" class="btn btn-outline-primary position-relative me-2">
                                <i class="fas fa-shopping-cart"></i>
                                <span class="cart-count position-absolute d-none">0</span>
                            </a>
                            <a href="#" id="languageToggle" class="btn btn-outline-secondary" onclick="return toggleLanguage();">Fran√ßais</a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Price Advantage Banner -->
    <div class="bg-primary text-white py-3">
        <div class="container">
            <div class="d-flex justify-content-center align-items-center">
                <i class="fas fa-tags me-2"></i>
                <span data-translate="price_advantage_banner">Free shipping across montreal</span>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active" data-bs-interval="3000">
                    <img src="images/slide-show-1.webp" class="d-block w-100" alt="Slide 1">
                </div>
                <div class="carousel-item" data-bs-interval="3000">
                    <img src="images/slide-show-2.jpg" class="d-block w-100" alt="Slide 2">
                </div>
                <div class="carousel-item" data-bs-interval="3000">
                    <img src="images/labubu-logo.png" class="d-block w-100" alt="Slide 3">
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </section>

    <!-- Featured Products -->
    <section class="featured-products py-5">
        <div class="container">
            <div class="row mb-4">
                <div class="col-12 text-center">
                    <h2 class="mb-3" data-translate="featured_products">Featured Products</h2>
                    <p class="text-muted" data-translate="featured_products_desc">Our most popular Labubu dolls and collectibles</p>
                </div>
            </div>
            <div class="row">
                <!-- Product cards will be dynamically inserted here by JavaScript -->
            </div>
            <div class="row mt-4">
                <div class="col-12 text-center">
                    <a href="shop.html" class="btn btn-outline-primary" data-translate="view_all_products">View All Products</a>
                </div>
            </div>
        </div>
    </section>


    <!-- New Arrivals -->
    <section class="new-arrivals py-5">
        <div class="container">
            <div class="row mb-4">
                <div class="col-12 text-center">
                    <h2 class="mb-3" data-translate="new_arrivals">New Arrivals</h2>
                    <p class="text-muted" data-translate="new_arrivals_desc">The latest additions to our Labubu collection</p>
                </div>
            </div>
            <div class="row">
                <!-- Product cards will be dynamically inserted here by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Best Sellers -->
    <section class="best-sellers py-5 bg-light">
        <div class="container">
            <div class="row mb-4">
                <div class="col-12 text-center">
                    <h2 class="mb-3" data-translate="best_sellers">Best Sellers</h2>
                    <p class="text-muted" data-translate="best_sellers_desc">Our most popular Labubu dolls loved by collectors</p>
                </div>
            </div>
            <div class="row">
                <!-- Product cards will be dynamically inserted here by JavaScript -->
            </div>
        </div>
    </section>


    <!-- Newsletter -->
    <section class="newsletter py-5 bg-primary text-white">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-8 text-center">
                    <h3 class="mb-3" data-translate="newsletter_title">Subscribe to Our Newsletter</h3>
                    <p class="mb-4" data-translate="newsletter_desc">Stay updated on new releases, restocks, and exclusive offers!</p>
                    <form class="row g-3">
                        <div class="col-12 col-md-8 mb-2 mb-md-0">
                            <input type="email" class="form-control" data-translate-placeholder="email_placeholder" placeholder="Your email address" required>
                        </div>
                        <div class="col-12 col-md-4">
                            <button type="submit" class="btn btn-light w-100" data-translate="subscribe_button">Subscribe</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-sm-6 mb-4 mb-lg-0">
                    <h5>LeLabubu.ca</h5>
                    <p data-translate="footer_description">Your local Montreal destination for authentic Labubu dolls with free shipping across montreal.</p>
                    <div class="social-icons">
                        <ul class="list-inline">
                            <li class="list-inline-item">
                                <a href="#"><i class="fab fa-facebook-f"></i></a>
                            </li>
                            <li class="list-inline-item">
                                <a href="#"><i class="fab fa-instagram"></i></a>
                            </li>
                            <li class="list-inline-item">
                                <a href="#"><i class="fab fa-twitter"></i></a>
                            </li>
                            <li class="list-inline-item">
                                <a href="#"><i class="fab fa-pinterest-p"></i></a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6 mb-4 mb-lg-0">
                    <h5 data-translate="footer_shop">Shop</h5>
                    <ul class="list-unstyled">
                        <li><a href="shop.html" data-translate="all_products">All Products</a></li>
                        <li><a href="#" data-translate="new_arrivals">New Arrivals</a></li>
                        <li><a href="#" data-translate="best_sellers">Best Sellers</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-sm-6 mb-4 mb-lg-0">
                    <h5 data-translate="footer_information">Information</h5>
                    <ul class="list-unstyled">
                        <li><a href="about.html" data-translate="about_us">About Us</a></li>
                        <li><a href="#" data-translate="shipping_policy">Shipping Policy</a></li>
                        <li><a href="#" data-translate="return_policy">Return Policy</a></li>
                        <li><a href="#" data-translate="privacy_policy">Privacy Policy</a></li>
                        <li><a href="#" data-translate="terms_conditions">Terms & Conditions</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-sm-6 mb-4 mb-lg-0">
                    <h5 data-translate="contact_us">Contact Us</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-map-marker-alt me-2"></i> 123 Doll Street, Montreal, QC H2Y 1C6</li>
                        <li class="mb-2"><i class="fas fa-phone me-2"></i> (514) 555-1234</li>
                        <li class="mb-2"><i class="fas fa-envelope me-2"></i> info@lelabubu.ca</li>
                    </ul>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    <p class="mb-0" data-translate="copyright">&copy; 2025 LeLabubu.ca. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="mb-0">
                        <img src="images/payment-methods.png" alt="Payment Methods" style="height: 24px; max-width: 100%;">
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="js/products.js"></script>
    <script src="js/main.js"></script>
    <script src="js/translations.js"></script>
    <script src="js/stripe.js"></script>

    <!-- Comments Section -->
    <section class="comments-section py-5">
        <div class="container">
            <h2 class="text-center mb-4">Community Comments</h2>
            <div id="comments-container" class="mb-4">
                <!-- Comments will be dynamically inserted here -->
            </div>
            <div id="comment-form-container">
                <!-- Comment form will be dynamically inserted here -->
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            async function fetchAndDisplayComments() {
                const commentsContainer = document.getElementById('comments-container');
                const response = await fetch('/api/comments');
                const comments = await response.json();

                if (comments.length > 0) {
                    commentsContainer.innerHTML = comments.map(comment => `
                        <div class="card mb-3">
                            <div class="card-body">
                                <h5 class="card-title">${comment.user}</h5>
                                <p class="card-text">${comment.content}</p>
                            </div>
                        </div>
                    `).join('');
                } else {
                    commentsContainer.innerHTML = '<p class="text-center">No comments yet. Be the first to leave a comment after making a purchase!</p>';
                }
            }

            async function checkUserAndDisplayCommentForm() {
                const commentFormContainer = document.getElementById('comment-form-container');
                const sessionResponse = await fetch('/api/session', {credentials: 'include'});
                const sessionData = await sessionResponse.json();

                if (sessionData.user) {
                    commentFormContainer.innerHTML = `
                        <h4 class="text-center">Leave a Comment</h4>
                        <form id="comment-form">
                            <div class="mb-3">
                                <textarea class="form-control" id="comment-text" rows="3" required placeholder="Write your comment here..."></textarea>
                            </div>
                            <div class="text-center">
                                <button type="submit" class="btn btn-primary">Submit Comment</button>
                            </div>
                        </form>
                        <div id="comment-message" class="alert mt-3 d-none"></div>
                    `;

                    document.getElementById('comment-form').addEventListener('submit', async (e) => {
                        e.preventDefault();
                        const content = document.getElementById('comment-text').value;
                        const response = await fetch('/api/comments', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            credentials: 'include',
                            body: JSON.stringify({ content })
                        });
                        const data = await response.json();
                        const commentMessage = document.getElementById('comment-message');
                        commentMessage.textContent = data.message || data.error;
                        commentMessage.className = `alert mt-3 ${response.ok ? 'alert-success' : 'alert-danger'}`;
                        commentMessage.classList.remove('d-none');

                        if (response.ok) {
                            document.getElementById('comment-text').value = '';
                            fetchAndDisplayComments();
                        }
                    });
                } else {
                    commentFormContainer.innerHTML = '<p class="text-center"><a href="login.html">Log in</a> to leave a comment.</p>';
                }
            }

            fetchAndDisplayComments();
            checkUserAndDisplayCommentForm();
        });
    </script>
</body>
</html>
